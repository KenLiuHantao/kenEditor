!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listenList=[]}return a(e,[{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i=!0;this.listenList.map(function(t,a,o){t.name==e&&(i=!1,t.func.apply(t,n))}),i&&console.warn(e+" not being monitored!")}},{key:"addEventListener",value:function(e,t){if("function"!=typeof t)return console.warn("The second parameter is not a function"),!1;var n=!1;this.listenList.map(function(t,a,i){t.name==e&&(n=!0)}),n?console.warn("Can't use same name! "):this.listenList.push({name:e,func:t})}},{key:"changeEventListener",value:function(e,t){this.listenList.map(function(n,a,i){n.name==e&&(n.func=t)})}},{key:"removeEventListener",value:function(e){for(var t=0;t>this.listenList.lengthl;t++)if(this.listenList.name==e){this.listenList.splice(t,1);break}}},{key:"getListenList",value:function(){return this.listenList}}]),e}());t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i={},o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=parseInt(1008611*Math.random()),this.from=t.from?t.from:{x:0,y:0},this.to=t.to?t.to:{x:0,y:0},this.active=!!t.active&&t.active,this.complete=!!t.complete&&t.complete,this.attr=t.attr?t.attr:{}}return a(e,[{key:"render",value:function(){var e=$kenEditor.canvas.getContext("2d");e.beginPath(),e.lineWidth=5,e.strokeStyle="#8a8787";var t={x:(this.from.x+this.to.x)/2,y:this.from.y},n={x:(this.from.x+this.to.x)/2,y:this.to.y},a={x:this.from.x+75,y:this.from.y},i={x:this.to.x-75,y:this.to.y};e.moveTo(a.x,a.y),i.x>a.x?e.bezierCurveTo(t.x,t.y,n.x,n.y,i.x-20,i.y):e.bezierCurveTo(t.x,t.y,n.x,n.y,i.x+20,i.y),e.stroke(),this.complete&&(e.beginPath(),i.x>a.x?(e.moveTo(i.x-10,i.y),e.lineTo(i.x-25,i.y+10),e.lineTo(i.x-25,i.y-10)):(e.moveTo(i.x+10,i.y),e.lineTo(i.x+25,i.y+10),e.lineTo(i.x+25,i.y-10)),e.closePath(),e.fillStyle="#8a8787",e.fill())}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i={},o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t.id?t.id:"",this.name=t.name?t.name:"",this.Alias=t.Alias?t.Alias:"",this.icon=t.icon?t.icon:null,this.x=t.x?t.x:0,this.y=t.y?t.y:0,this.type=t.type?t.type:0,this.active=!!t.active&&t.active,this.attr=t.attr?t.attr:{}}return a(e,[{key:"render",value:function(){var e=$kenEditor.canvas.getContext("2d");e.lineWidth=2,this.active?e.fillStyle="rgba(66,139,202,0.3)":e.fillStyle="#ccc",e.roundRect(this.x-75,this.y-50,150,100,10).fill(),e.strokeStyle="#8a8787",e.roundRect(this.x-75,this.y-50,150,100,10).stroke(),e.font="35px iconfont";var t=document.createElement("i");t.innerHTML=this.icon;var n=t.textContent;e.fillStyle="black",null!=this.icon&&"null"!=this.icon?(e.fillText(n,this.x-e.measureText(n).width/2,this.y),e.font="18px Arial bold",e.fillText(this.name,this.x-e.measureText(this.name).width/2,this.y+30)):(e.font="18px Arial bold",e.fillText(this.name,this.x-e.measureText(this.name).width/2,this.y+10)),e.beginPath(),"sourceData"==this.type?e.arc(this.x+75,this.y,10,0,2*Math.PI):"targetData"==this.type?e.arc(this.x-75,this.y,10,0,2*Math.PI):(e.arc(this.x+75,this.y,10,0,2*Math.PI),e.stroke(),e.fillStyle="#fff",e.fill(),e.closePath(),e.beginPath(),e.arc(this.x-75,this.y,10,0,2*Math.PI)),e.stroke(),e.fillStyle="#fff",e.fill(),e.closePath()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),r=(a=o)&&a.__esModule?a:{default:a};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasLineList=[],this.selectLine=null}return i(e,[{key:"setCanvasLine",value:function(e){this.canvasLineList=e}},{key:"getCanvasLineList",value:function(){return this.canvasLineList}},{key:"addCanvasLine",value:function(e){this.canvasLineList.push(e);new r.default(e)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),r=(a=o)&&a.__esModule?a:{default:a};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasNodeList=[],this.selectLine=null}return i(e,[{key:"setCanvasNodeList",value:function(e){this.canvasNodeList=e}},{key:"getCanvasNodeList",value:function(){return this.canvasNodeList}},{key:"changeCanvasNodeListIndex",value:function(e,t){var n=this.canvasNodeList[t];this.canvasNodeList[t]=this.canvasNodeList[e],this.canvasNodeList[e]=n}},{key:"addCanvasNode",value:function(e){this.canvasNodeList.push(e),new r.default(e).render()}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),s=(a=r)&&a.__esModule?a:{default:a};var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"createNodeDom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"!=(void 0===e?"undefined":i(e))&&console.warn("Wrong parameters!");var t=document.createElement("li"),n=document.createElement("div");if(null!=e.icon?n.innerHTML=e.icon+e.name:n.innerHTML=e.name,n.setAttribute("class","iconfont nodeIcon "),n.setAttribute("title",e.name),n.setAttribute("type",e.type),t.appendChild(n),e.child){var a=document.createElement("i");a.setAttribute("class","menu-submenu-arrow"),n.appendChild(a);for(var o=document.createElement("ul"),r=function(){c=document.createElement("li"),null!=e.child[l].icon?c.innerHTML=e.child[l].icon+e.child[l].name:c.innerHTML=e.child[l].name,c.setAttribute("class","iconfont secLiIcon "),c.setAttribute("title",e.child[l].name),c.setAttribute("_type",e.child[l].type),c.setAttribute("draggable",!0),o.appendChild(c);var t=e.child[l];c.addEventListener("dragstart",function(e){s.default.emit("addNode",t,e)})},l=0;l<e.child.length;l++){var c;r()}t.appendChild(o)}return n.addEventListener("click",function(e){e.target.parentNode.getAttribute("class")&&-1!=e.target.parentNode.getAttribute("class").indexOf("unable")?e.target.parentNode.setAttribute("class",""):e.target.parentNode.setAttribute("class","unable")}),t}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=["all","enter","dataBase"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=[{name:"数据源",icon:"",type:"firstLv",child:[{name:"KAFKA",icon:"&#xe65a;",type:"sourceData"},{name:"ElasticSearch",icon:"&#xe80f;",type:"sourceData"},{name:"Hive",icon:"&#xe601;",type:"sourceData"},{name:"Hbase",icon:"&#xe6e7;",type:"sourceData"}]},{name:"算子",icon:"",type:"firstLv",child:[{name:"算子1",icon:"",type:"tools"},{name:"算子2",icon:"",type:"tools"},{name:"算子3",icon:"",type:"tools"},{name:"算子4",icon:null,type:"tools"}]},{name:"目的地",icon:"",type:"firstLv",child:[{name:"KAFKA",icon:"&#xe65a;",type:"targetData"},{name:"ElasticSearch",icon:"&#xe80f;",type:"targetData"},{name:"Hive",icon:"&#xe601;",type:"targetData"},{name:"Hbase",icon:"&#xe6e7;",type:"targetData"}]}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=s(n(7)),o=s(n(6)),r=s(n(5));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type="all",this.keyword="",this.nodeList=this._loadDefaultListConfig(),this.render()}return a(e,[{key:"_loadDefaultListConfig",value:function(){return i.default}},{key:"render",value:function(){if(document.querySelector("#nodeList"))console.warn("Can't build second nodeList");else{var e=document.createElement("div");if(e.setAttribute("id","nodeList"),null!==document.querySelector("#"+this.id)){for(var t=document.createElement("select"),n=0;n<o.default.length;n++){var a=document.createElement("option");a.setAttribute("value",o.default[n]),a.appendChild(document.createTextNode(o.default[n])),t.appendChild(a)}e.appendChild(t),document.querySelector("#"+this.id).firstChild?document.querySelector("#"+this.id).insertBefore(e,document.querySelector("#"+this.id).firstChild):document.querySelector("#"+this.id).appendChild(e);var i=this;t.addEventListener("change",function(){i.changeType(t.value)});var s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("placeholder","请输入关键字"),e.appendChild(s);var l=document.createElement("ul"),c=new r.default;for(n=0;n<this.nodeList.length;n++){var u=c.createNodeDom(this.nodeList[n]);l.appendChild(u)}e.appendChild(l)}else console.error("Can't find DOM with #"+this.id+"!")}}},{key:"setNodeList",value:function(e){this.nodeList=e}},{key:"clearRender",value:function(){document.getElementById(this.id).removeChild(document.getElementById("nodeList"))}},{key:"changeType",value:function(e){this.type=e,console.log(this.type)}}]),e}();t.default=l},function(e,t,n){"use strict";var a,i=n(0),o=(a=i)&&a.__esModule?a:{default:a};o.default.addEventListener("saveTask",function(){console.log("保存")}),o.default.addEventListener("goBack",function(){console.log("后退")}),o.default.addEventListener("goAhead",function(){console.log("前进")}),o.default.addEventListener("copy",function(){console.log("复制")}),o.default.addEventListener("paste",function(){console.log("粘贴")}),o.default.addEventListener("delete",function(){console.log("删除")}),o.default.addEventListener("setBig",function(){console.log("放大")}),o.default.addEventListener("setSmall",function(){console.log("缩小")}),o.default.addEventListener("setAuto",function(){console.log("适应画布")}),o.default.addEventListener("setDefault",function(){console.log("实际尺寸")}),o.default.addEventListener("changeBackgroundLine",function(e){var t=$kenEditor.bgCanvas;-1!=e.getAttribute("class").indexOf("active")?(e.setAttribute("class",e.getAttribute("class").replace("active","default")),t.clearBackground()):(e.setAttribute("class",e.getAttribute("class").replace("default","active")),t.setBackground("line"))}),o.default.addEventListener("changeBackgroundPoint",function(e){var t=$kenEditor.bgCanvas;-1!=e.getAttribute("class").indexOf("active")?(e.setAttribute("class",e.getAttribute("class").replace("active","default")),t.clearBackground()):(e.setAttribute("class",e.getAttribute("class").replace("default","active")),t.setBackground("point"))}),o.default.addEventListener("addNode",function(e,t){t.dataTransfer.setData("icon",e.icon),t.dataTransfer.setData("name",e.name),t.dataTransfer.setData("type",e.type)}),CanvasRenderingContext2D.prototype.roundRect=function(e,t,n,a,i){return n<2*i&&(i=n/2),a<2*i&&(i=a/2),this.beginPath(),this.moveTo(e+i,t),this.arcTo(e+n,t,e+n,t+a,i),this.arcTo(e+n,t+a,e,t+a,i),this.arcTo(e,t+a,e,t,i),this.arcTo(e,t,e+n,t,i),this.closePath(),this},document.addEventListener("keyup",function(e){var t=$kenEditor.baseModel,n=$kenEditor.canvasNodeList,a=$kenEditor.canvasLineList;if(46==e.keyCode&&n.selectNode){var i,o=n.getCanvasNodeList().filter(function(e){return e.active&&(i=e),1!=e.active}),r=a.getCanvasLineList().filter(function(e){if(e.from!=i&&e.to!=i)return e});n.setCanvasNodeList(o),a.setCanvasLine(r),t.clearAll(t),t.renderLine(t),t.renderNode(t)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),s=(a=r)&&a.__esModule?a:{default:a};n(9);var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={}}return o(e,[{key:"createControllerDom",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"object"!=(void 0===t?"undefined":i(t))&&console.warn("Wrong parameters!"),"separator"==t.class?((e=document.createElement("span")).setAttribute("class",t.class),e):((e=document.createElement("i")).innerHTML=t.icon,e.setAttribute("class","iconfont singleController "+t.class),e.setAttribute("title",t.popup),e.setAttribute("status",t.status),t.eventName&&this.addDomEvent(e,t.eventName),e)}},{key:"addDomEvent",value:function(e,t){e.addEventListener("click",function(){"disable"!=e.getAttribute("status")&&s.default.emit(t,e)})}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=[{name:"保存",icon:"&#xe688;",popup:"保存",class:"default",eventName:"saveTask",status:""},{name:"后退",icon:"&#xe63a;",popup:"后退",class:"default",eventName:"goBack",status:""},{name:"前进",icon:"&#xe63b;",popup:"前进",class:"disable",eventName:"goAhead",status:"disable"},{class:"separator"},{name:"复制",icon:"&#xe66a;",popup:"复制",class:"default",eventName:"copy",status:""},{name:"粘贴",icon:"&#xe62b;",popup:"粘贴",class:"disable",eventName:"paste",status:"disable"},{name:"删除",icon:"&#xe61e;",popup:"删除",class:"disable",eventName:"delete",status:"disable"},{class:"separator"},{name:"放大",icon:"&#xe600;",popup:"放大",class:"default",eventName:"setBig",status:""},{name:"缩小",icon:"&#xe69a;",popup:"缩小",class:"default",eventName:"setSmall",status:""},{name:"适应画布",icon:"&#xe61d;",popup:"适应画布",class:"default",eventName:"setAuto",status:""},{name:"实际尺寸",icon:"&#xe62a;",popup:"实际尺寸",class:"default",eventName:"setDefault",status:""},{class:"separator"},{name:"网格背景",icon:"&#xe9bd;",popup:"网格背景",class:"active",eventName:"changeBackgroundLine",status:""},{name:"点线背景",icon:"&#xe74b;",popup:"点线背景",class:"default",eventName:"changeBackgroundPoint",status:""}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=s(n(11)),r=s(n(10));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.controllerList=this._loadDefaultControllerConfig(),this._createControllerList(t)}return i(e,[{key:"_createControllerList",value:function(e){if(document.querySelector("#controllerList"))console.warn("Can't build second controllerList");else{var t=document.createElement("div");if(t.setAttribute("id","controllerList"),null!==document.querySelector("#"+e)){for(var n=new r.default,a=0;a<this.controllerList.length;a++){var i=n.createControllerDom(this.controllerList[a]);t.appendChild(i)}document.querySelector("#"+e).firstChild?document.querySelector("#"+e).insertBefore(t,document.querySelector("#"+e).firstChild):document.querySelector("#"+e).appendChild(t)}else console.error("Can't find DOM with #"+e+"!")}}},{key:"_loadDefaultControllerConfig",value:function(){return o.default}},{key:"addController",value:function(e){"object"!=(void 0===e?"undefined":a(e))&&console.warn("Wrong parameters!"),this.controllerList.push(e),this.render()}},{key:"changeControllerIndex",value:function(e,t){var n=this.controllerList[t];this.controllerList[t]=this.controllerList[e],this.controllerList[e]=n,this.render()}},{key:"deleteControllerByIndex",value:function(e){this.controllerList.splice(e,1),this.render()}},{key:"deleteControllerByName",value:function(e){for(var t=null,n=0;n<this.controllerList.length;n++)if(controllerList[n].name==e){t=n;break}(t||0==n)&&this.controllerList.splice(t,1),this.render()}},{key:"render",value:function(){var e=document.getElementById("controllerList");e.parentNode.removeChild(e),this._createControllerList(this.id)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),document.querySelector("#canvasBg"))console.warn("Can't build second bgModel");else if(null!==document.querySelector("#"+t)){this.style="line";var n=document.createElement("canvas");n.setAttribute("id","canvasBg");var a=document.createElement("div");a.setAttribute("id","editor-clear");var i=this;setTimeout(function(){n.setAttribute("width",document.querySelector("#"+t).offsetWidth-200),n.setAttribute("height","600"),document.querySelector("#"+t).appendChild(n),document.querySelector("#"+t).appendChild(a),i.setBackground(i.style)},200),this.canvas=n}else console.error("Can't find DOM with #"+t+"!")}return a(e,[{key:"setBackground",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line",t=this.canvas,n=t.getContext("2d"),a=t.getAttribute("width"),i=t.getAttribute("height");switch(n.beginPath(),n.save(),n.translate(.5,.5),n.lineWidth=1,e&&(this.style=e),this.style){case"line":n.strokeStyle="rgba(0,0,0,0.05)";for(var o=1;o<a/20;o++)n.beginPath(),n.moveTo(20*o,0),n.lineTo(20*o,i),n.stroke();for(o=1;o<i/20;o++)n.beginPath(),n.moveTo(0,20*o),n.lineTo(a,20*o),n.stroke();break;case"point":n.fillStyle="rgba(0,0,0,0.25)";for(o=1;o<a/20;o++)for(var r=1;r<i/20;r++)n.beginPath(),n.arc(20*o,20*r,1,0,360,!0),n.fill();break;default:console.warn("At this version,We only support backGround for line or point")}n.restore()}},{key:"clearBackground",value:function(){var e=this.canvas;e.getContext("2d").clearRect(0,0,e.getAttribute("width"),e.getAttribute("height"))}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=r(n(2)),o=r(n(1));r(n(0));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),document.querySelector("#baseCanvas"))console.warn("Can't build second baseModel");else if(null!==document.querySelector("#"+t)){var n=document.createElement("canvas");n.setAttribute("id","baseCanvas"),this.build=!1;var a=this;setTimeout(function(){n.setAttribute("width",document.querySelector("#"+t).offsetWidth-200),n.setAttribute("height","600"),document.querySelector("#"+t).appendChild(n),a.build=!0,a._addDragListener(),a._addMouseDownListener(),a._addMouseMoveListener(),a._addMouseUpListener()},100),this.canvas=n,this.ctx=n.getContext("2d"),this.addOnce=!1,this.isdragging=!1,this.isLineing=!1,this.draggingOffsetX=0,this.draggingOffsetY=0}else console.error("Can't find DOM with #"+t+"!")}return a(e,[{key:"clearAll",value:function(e){e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"renderNode",value:function(e){var t=$kenEditor.canvasNodeList;if(e.build)for(var n=0;n<t.canvasNodeList.length;n++){new i.default(t.canvasNodeList[n]).render()}else setTimeout(function(){e.renderNode(e)},200)}},{key:"renderLine",value:function(e){var t=$kenEditor.canvasLineList;if(e.build)for(var n=0;n<t.canvasLineList.length;n++){new o.default(t.canvasLineList[n]).render()}else setTimeout(function(){e.renderLine(e)},200)}},{key:"_addDragListener",value:function(){var e=$kenEditor.canvasNodeList;this.addOnce||(document.addEventListener("dragover",function(e){e.preventDefault()}),this.canvas.addEventListener("drop",function(t){if(t.dataTransfer.getData("name")){var n={id:parseInt(1008611*Math.random()),icon:t.dataTransfer.getData("icon"),name:t.dataTransfer.getData("name"),type:t.dataTransfer.getData("type"),x:t.offsetX,y:t.offsetY};e.addCanvasNode(n)}else t.preventDefault()}),this.addOnce=!0)}},{key:"_addMouseDownListener",value:function(){var e=this,t=$kenEditor.canvasNodeList,n=$kenEditor.canvasLineList;this.canvas.onmousedown=function(a){var i=a.offsetX,o=a.offsetY,r=t.canvasNodeList;null!=t.selectNode&&(t.selectNode.active=!1,t.selectNode=null),null!=n.selectLine&&(n.selectLine.active=!1,n.selectLine=null),e.clearAll(e),e.renderLine(e),e.renderNode(e);for(var s=r.length-1;s>=0;s--){if("targetData"==(c=r[s]).type);else if(c.x+85>=i&&i>=c.x+65&&c.y-10<=o&&o<=c.y+10){var l={from:c,to:{x:c.x+95,y:c.y},active:!1,complete:!1,attr:{}};return n.addCanvasLine(l),n.selectLine=l,void(e.isLineing=!0)}}for(s=r.length-1;s>=0;s--){var c;if((c=r[s]).x-75<=i&&i<=c.x+75&&c.y-50<=o&&o<=c.y+50){null!=t.selectNode&&(t.selectNode.active=!1),t.selectNode=c,e.draggingOffsetX=i-c.x,e.draggingOffsetY=o-c.y,c.active=!0,e.isdragging=!0,t.changeCanvasNodeListIndex(s,r.length-1),e.clearAll(e),e.renderLine(e),e.renderNode(e);break}}}}},{key:"_addMouseMoveListener",value:function(){var e=this,t=$kenEditor.canvasNodeList,n=$kenEditor.canvasLineList;this.canvas.onmousemove=function(a){if(e.isdragging){var i=a.offsetX,o=a.offsetY;t.selectNode.x=i-e.draggingOffsetX,t.selectNode.y=o-e.draggingOffsetY,e.clearAll(e),e.renderLine(e),e.renderNode(e)}if(e.isLineing){var r=a.offsetX,s=a.offsetY;n.selectLine.to={x:r+95,y:s},e.clearAll(e),e.renderLine(e),e.renderNode(e)}}}},{key:"_addMouseUpListener",value:function(){var e=this,t=$kenEditor.canvasLineList,n=$kenEditor.canvasNodeList;this.canvas.onmouseup=function(a){var i=a.offsetX,o=a.offsetY;if(e.isdragging&&(e.isdragging=!1,e.draggingOffsetX=0,e.draggingOffsetY=0),e.isLineing){var r=n.canvasNodeList;e.isLineing=!1;for(var s=r.length-1;s>=0;s--){var l=r[s];if("sourceData"==l.type);else if(i>=l.x-85&&i<=l.x-65&&l.y-10<=o&&o<=l.y+10){t.selectLine.to=l;for(var c=!1,u=0;u<t.canvasLineList.length-1;u++)t.canvasLineList[u].from==t.selectLine.from&&t.canvasLineList[u].to==t.selectLine.to&&(c=!0);if(!c)return t.selectLine.complete=!0,e.clearAll(e),e.renderLine(e),void e.renderNode(e)}}t.canvasLineList.splice(t.canvasLineList.length-1,1),e.clearAll(e),e.renderLine(e),e.renderNode(e)}}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(14)),i=u(n(13)),o=u(n(0)),r=u(n(12)),s=u(n(8)),l=u(n(4)),c=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}n(26),n(21);var d={init:function(e,t,n){d.bgCanvas=new i.default(e),d.canvasNodeList=new l.default,d.canvasLineList=new c.default,d.baseModel=new a.default(e),d.canvas=d.baseModel.canvas,d.controllerList=new r.default(e),d.nodeList=new s.default(e),d.EventController=o.default}};window.$kenEditor=d,d.init("app"),t.default=d},,,,,,function(e,t){},,,,,function(e,t){}]);
//# sourceMappingURL=bundle-6b7f446665d7ee6ecb08.js.map